/*
 * jQuery Pines Notify (pnotify) Plugin 1.2.0
 *
 * http://pinesframework.org/pnotify/
 * Copyright (c) 2009-2012 Hunter Perrin
 *
 * Triple license under the GPL, LGPL, and MPL:
 *	  http://www.gnu.org/licenses/gpl.html
 *	  http://www.gnu.org/licenses/lgpl.html
 *	  http://www.mozilla.org/MPL/MPL-1.1.html
 */

(function(e){var t,n,r,i=e(window),s={jqueryui:{container:"ui-widget ui-widget-content ui-corner-all",notice:"ui-state-highlight",notice_icon:"ui-icon ui-icon-info",info:"",info_icon:"ui-icon ui-icon-info",success:"ui-state-default",success_icon:"ui-icon ui-icon-circle-check",error:"ui-state-error",error_icon:"ui-icon ui-icon-alert",closer:"ui-icon ui-icon-close",pin_up:"ui-icon ui-icon-pin-w",pin_down:"ui-icon ui-icon-pin-s",hi_menu:"ui-state-default ui-corner-bottom",hi_btn:"ui-state-default ui-corner-all",hi_btnhov:"ui-state-hover",hi_hnd:"ui-icon ui-icon-grip-dotted-horizontal"},bootstrap:{container:"alert",notice:"",notice_icon:"icon-exclamation-sign",info:"alert-info",info_icon:"icon-info-sign",success:"alert-success",success_icon:"icon-ok-sign",error:"alert-error",error_icon:"icon-warning-sign",closer:"icon-remove",pin_up:"icon-pause",pin_down:"icon-play",hi_menu:"well",hi_btn:"btn",hi_btnhov:"",hi_hnd:"icon-chevron-down"}},o=function(){r=e("body"),i=e(window),i.bind("resize",function(){n&&clearTimeout(n),n=setTimeout(e.pnotify_position_all,10)})};document.body?o():e(o),e.extend({pnotify_remove_all:function(){var t=i.data("pnotify");t&&t.length&&e.each(t,function(){this.pnotify_remove&&this.pnotify_remove()})},pnotify_position_all:function(){n&&clearTimeout(n),n=null;var t=i.data("pnotify");t&&t.length&&(e.each(t,function(){var e=this.opts.stack;e&&(e.nextpos1=e.firstpos1,e.nextpos2=e.firstpos2,e.addpos2=0,e.animation=!0)}),e.each(t,function(){this.pnotify_position()}))},pnotify:function(o){var u,a;typeof o!="object"?(a=e.extend({},e.pnotify.defaults),a.text=o):a=e.extend({},e.pnotify.defaults,o);for(var f in a)typeof f=="string"&&f.match(/^pnotify_/)&&(a[f.replace(/^pnotify_/,"")]=a[f]);if(a.before_init&&a.before_init(a)===!1)return null;var l,h=function(t,n){v.css("display","none");var r=document.elementFromPoint(t.clientX,t.clientY);v.css("display","block");var i=e(r),s=i.css("cursor");v.css("cursor",s!="auto"?s:"default");if(!l||l.get(0)!=r)l&&(c.call(l.get(0),"mouseleave",t.originalEvent),c.call(l.get(0),"mouseout",t.originalEvent)),c.call(r,"mouseenter",t.originalEvent),c.call(r,"mouseover",t.originalEvent);c.call(r,n,t.originalEvent),l=i},p=s[a.styling],v=e("<div />",{"class":"ui-pnotify "+a.addclass,css:{display:"none"},mouseenter:function(e){a.nonblock&&e.stopPropagation(),a.mouse_reset&&u=="out"&&(v.stop(!0),u="in",v.css("height","auto").animate({width:a.width,opacity:a.nonblock?a.nonblock_opacity:a.opacity},"fast")),a.nonblock&&v.animate({opacity:a.nonblock_opacity},"fast"),a.hide&&a.mouse_reset&&v.pnotify_cancel_remove(),a.sticker&&!a.nonblock&&v.sticker.trigger("pnotify_icon").css("visibility","visible"),a.closer&&!a.nonblock&&v.closer.css("visibility","visible")},mouseleave:function(t){a.nonblock&&t.stopPropagation(),l=null,v.css("cursor","auto"),a.nonblock&&u!="out"&&v.animate({opacity:a.opacity},"fast"),a.hide&&a.mouse_reset&&v.pnotify_queue_remove(),a.sticker_hover&&v.sticker.css("visibility","hidden"),a.closer_hover&&v.closer.css("visibility","hidden"),e.pnotify_position_all()},mouseover:function(e){a.nonblock&&e.stopPropagation()},mouseout:function(e){a.nonblock&&e.stopPropagation()},mousemove:function(e){a.nonblock&&(e.stopPropagation(),h(e,"onmousemove"))},mousedown:function(e){a.nonblock&&(e.stopPropagation(),e.preventDefault(),h(e,"onmousedown"))},mouseup:function(e){a.nonblock&&(e.stopPropagation(),e.preventDefault(),h(e,"onmouseup"))},click:function(e){a.nonblock&&(e.stopPropagation(),h(e,"onclick"))},dblclick:function(e){a.nonblock&&(e.stopPropagation(),h(e,"ondblclick"))}});v.opts=a,v.container=e("<div />",{"class":p.container+" ui-pnotify-container "+(a.type=="error"?p.error:a.type=="info"?p.info:a.type=="success"?p.success:p.notice)}).appendTo(v),a.cornerclass!=""&&v.container.removeClass("ui-corner-all").addClass(a.cornerclass),a.shadow&&v.container.addClass("ui-pnotify-shadow"),v.pnotify_version="1.2.0",v.pnotify=function(t){var n=a;typeof t=="string"?a.text=t:a=e.extend({},a,t);for(var r in a)typeof r=="string"&&r.match(/^pnotify_/)&&(a[r.replace(/^pnotify_/,"")]=a[r]);v.opts=a,a.cornerclass!=n.cornerclass&&v.container.removeClass("ui-corner-all").addClass(a.cornerclass),a.shadow!=n.shadow&&(a.shadow?v.container.addClass("ui-pnotify-shadow"):v.container.removeClass("ui-pnotify-shadow")),a.addclass===!1?v.removeClass(n.addclass):a.addclass!==n.addclass&&v.removeClass(n.addclass).addClass(a.addclass),a.title===!1?v.title_container.slideUp("fast"):a.title!==n.title&&(a.title_escape?v.title_container.text(a.title).slideDown(200):v.title_container.html(a.title).slideDown(200)),a.text===!1?v.text_container.slideUp("fast"):a.text!==n.text&&(a.text_escape?v.text_container.text(a.text).slideDown(200):v.text_container.html(a.insert_brs?String(a.text).replace(/\n/g,"<br />"):a.text).slideDown(200)),v.pnotify_history=a.history,v.pnotify_hide=a.hide,a.type!=n.type&&v.container.removeClass(p.error+" "+p.notice+" "+p.success+" "+p.info).addClass(a.type=="error"?p.error:a.type=="info"?p.info:a.type=="success"?p.success:p.notice);if(a.icon!==n.icon||a.icon===!0&&a.type!=n.type)v.container.find("div.ui-pnotify-icon").remove(),a.icon!==!1&&e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":a.icon===!0?a.type=="error"?p.error_icon:a.type=="info"?p.info_icon:a.type=="success"?p.success_icon:p.notice_icon:a.icon})).prependTo(v.container);return a.width!==n.width&&v.animate({width:a.width}),a.min_height!==n.min_height&&v.container.animate({minHeight:a.min_height}),a.opacity!==n.opacity&&v.fadeTo(a.animate_speed,a.opacity),!a.closer||a.nonblock?v.closer.css("display","none"):v.closer.css("display","block"),!a.sticker||a.nonblock?v.sticker.css("display","none"):v.sticker.css("display","block"),v.sticker.trigger("pnotify_icon"),a.sticker_hover?v.sticker.css("visibility","hidden"):a.nonblock||v.sticker.css("visibility","visible"),a.closer_hover?v.closer.css("visibility","hidden"):a.nonblock||v.closer.css("visibility","visible"),a.hide?n.hide||v.pnotify_queue_remove():v.pnotify_cancel_remove(),v.pnotify_queue_position(),v},v.pnotify_position=function(e){var t=v.opts.stack;if(t){t.nextpos1||(t.nextpos1=t.firstpos1),t.nextpos2||(t.nextpos2=t.firstpos2),t.addpos2||(t.addpos2=0);var n=v.css("display")=="none";if(!n||e){var r,s={},o;switch(t.dir1){case"down":o="top";break;case"up":o="bottom";break;case"left":o="right";break;case"right":o="left"}e=parseInt(v.css(o)),isNaN(e)&&(e=0),typeof t.firstpos1=="undefined"&&!n&&(t.firstpos1=e,t.nextpos1=t.firstpos1);var u;switch(t.dir2){case"down":u="top";break;case"up":u="bottom";break;case"left":u="right";break;case"right":u="left"}r=parseInt(v.css(u)),isNaN(r)&&(r=0),typeof t.firstpos2=="undefined"&&!n&&(t.firstpos2=r,t.nextpos2=t.firstpos2);if(t.dir1=="down"&&t.nextpos1+v.height()>i.height()||t.dir1=="up"&&t.nextpos1+v.height()>i.height()||t.dir1=="left"&&t.nextpos1+v.width()>i.width()||t.dir1=="right"&&t.nextpos1+v.width()>i.width())t.nextpos1=t.firstpos1,t.nextpos2+=t.addpos2+(typeof t.spacing2=="undefined"?25:t.spacing2),t.addpos2=0;if(t.animation&&t.nextpos2<r)switch(t.dir2){case"down":s.top=t.nextpos2+"px";break;case"up":s.bottom=t.nextpos2+"px";break;case"left":s.right=t.nextpos2+"px";break;case"right":s.left=t.nextpos2+"px"}else v.css(u,t.nextpos2+"px");switch(t.dir2){case"down":case"up":v.outerHeight(!0)>t.addpos2&&(t.addpos2=v.height());break;case"left":case"right":v.outerWidth(!0)>t.addpos2&&(t.addpos2=v.width())}if(t.nextpos1)if(t.animation&&(e>t.nextpos1||s.top||s.bottom||s.right||s.left))switch(t.dir1){case"down":s.top=t.nextpos1+"px";break;case"up":s.bottom=t.nextpos1+"px";break;case"left":s.right=t.nextpos1+"px";break;case"right":s.left=t.nextpos1+"px"}else v.css(o,t.nextpos1+"px");(s.top||s.bottom||s.right||s.left)&&v.animate(s,{duration:500,queue:!1});switch(t.dir1){case"down":case"up":t.nextpos1+=v.height()+(typeof t.spacing1=="undefined"?25:t.spacing1);break;case"left":case"right":t.nextpos1+=v.width()+(typeof t.spacing1=="undefined"?25:t.spacing1)}}}},v.pnotify_queue_position=function(t){n&&clearTimeout(n),t||(t=10),n=setTimeout(e.pnotify_position_all,t)},v.pnotify_display=function(){v.parent().length||v.appendTo(r),a.before_open&&a.before_open(v)===!1||(a.stack.push!="top"&&v.pnotify_position(!0),a.animation=="fade"||a.animation.effect_in=="fade"?v.show().fadeTo(0,0).hide():a.opacity!=1&&v.show().fadeTo(0,a.opacity).hide(),v.animate_in(function(){a.after_open&&a.after_open(v),v.pnotify_queue_position(),a.hide&&v.pnotify_queue_remove()}))},v.pnotify_remove=function(){v.timer&&(window.clearTimeout(v.timer),v.timer=null),a.before_close&&a.before_close(v)===!1||v.animate_out(function(){a.after_close&&a.after_close(v)===!1||(v.pnotify_queue_position(),a.remove&&v.detach())})},v.animate_in=function(e){u="in";var t;t=typeof a.animation.effect_in!="undefined"?a.animation.effect_in:a.animation,t=="none"?(v.show(),e()):t=="show"?v.show(a.animate_speed,e):t=="fade"?v.show().fadeTo(a.animate_speed,a.opacity,e):t=="slide"?v.slideDown(a.animate_speed,e):typeof t=="function"?t("in",e,v):v.show(t,typeof a.animation.options_in=="object"?a.animation.options_in:{},a.animate_speed,e)},v.animate_out=function(e){u="out";var t;t=typeof a.animation.effect_out!="undefined"?a.animation.effect_out:a.animation,t=="none"?(v.hide(),e()):t=="show"?v.hide(a.animate_speed,e):t=="fade"?v.fadeOut(a.animate_speed,e):t=="slide"?v.slideUp(a.animate_speed,e):typeof t=="function"?t("out",e,v):v.hide(t,typeof a.animation.options_out=="object"?a.animation.options_out:{},a.animate_speed,e)},v.pnotify_cancel_remove=function(){v.timer&&window.clearTimeout(v.timer)},v.pnotify_queue_remove=function(){v.pnotify_cancel_remove(),v.timer=window.setTimeout(function(){v.pnotify_remove()},isNaN(a.delay)?0:a.delay)},v.closer=e("<div />",{"class":"ui-pnotify-closer",css:{cursor:"pointer",visibility:a.closer_hover?"hidden":"visible"},click:function(){v.pnotify_remove(),v.sticker.css("visibility","hidden"),v.closer.css("visibility","hidden")}}).append(e("<span />",{"class":p.closer})).appendTo(v.container),(!a.closer||a.nonblock)&&v.closer.css("display","none"),v.sticker=e("<div />",{"class":"ui-pnotify-sticker",css:{cursor:"pointer",visibility:a.sticker_hover?"hidden":"visible"},click:function(){a.hide=!a.hide,a.hide?v.pnotify_queue_remove():v.pnotify_cancel_remove(),e(this).trigger("pnotify_icon")}}).bind("pnotify_icon",function(){e(this).children().removeClass(p.pin_up+" "+p.pin_down).addClass(a.hide?p.pin_up:p.pin_down)}).append(e("<span />",{"class":p.pin_up})).appendTo(v.container),(!a.sticker||a.nonblock)&&v.sticker.css("display","none"),a.icon!==!1&&e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":a.icon===!0?a.type=="error"?p.error_icon:a.type=="info"?p.info_icon:a.type=="success"?p.success_icon:p.notice_icon:a.icon})).prependTo(v.container),v.title_container=e("<h4 />",{"class":"ui-pnotify-title"}).appendTo(v.container),a.title===!1?v.title_container.hide():a.title_escape?v.title_container.text(a.title):v.title_container.html(a.title),v.text_container=e("<div />",{"class":"ui-pnotify-text"}).appendTo(v.container),a.text===!1?v.text_container.hide():a.text_escape?v.text_container.text(a.text):v.text_container.html(a.insert_brs?String(a.text).replace(/\n/g,"<br />"):a.text),typeof a.width=="string"&&v.css("width",a.width),typeof a.min_height=="string"&&v.container.css("min-height",a.min_height),v.pnotify_history=a.history,v.pnotify_hide=a.hide;var m=i.data("pnotify");if(m==null||typeof m!="object")m=[];m=a.stack.push=="top"?e.merge([v],m):e.merge(m,[v]),i.data("pnotify",m),a.stack.push=="top"&&v.pnotify_queue_position(1),a.after_init&&a.after_init(v);if(a.history){var g=i.data("pnotify_history");typeof g=="undefined"&&(g=e("<div />",{"class":"ui-pnotify-history-container "+p.hi_menu,mouseleave:function(){g.animate({top:"-"+t+"px"},{duration:100,queue:!1})}}).append(e("<div />",{"class":"ui-pnotify-history-header",text:"Redisplay"})).append(e("<button />",{"class":"ui-pnotify-history-all "+p.hi_btn,text:"All",mouseenter:function(){e(this).addClass(p.hi_btnhov)},mouseleave:function(){e(this).removeClass(p.hi_btnhov)},click:function(){return e.each(m,function(){this.pnotify_history&&(this.is(":visible")?this.pnotify_hide&&this.pnotify_queue_remove():this.pnotify_display&&this.pnotify_display())}),!1}})).append(e("<button />",{"class":"ui-pnotify-history-last "+p.hi_btn,text:"Last",mouseenter:function(){e(this).addClass(p.hi_btnhov)},mouseleave:function(){e(this).removeClass(p.hi_btnhov)},click:function(){var e=-1,t;do{t=e==-1?m.slice(e):m.slice(e,e+1);if(!t[0])break;e--}while(!t[0].pnotify_history||t[0].is(":visible"));return t[0]?(t[0].pnotify_display&&t[0].pnotify_display(),!1):!1}})).appendTo(r),t=e("<span />",{"class":"ui-pnotify-history-pulldown "+p.hi_hnd,mouseenter:function(){g.animate({top:"0"},{duration:100,queue:!1})}}).appendTo(g).offset().top+2,g.css({top:"-"+t+"px"}),i.data("pnotify_history",g))}return a.stack.animation=!1,v.pnotify_display(),v}});var u=/^on/,a=/^(dbl)?click$|^mouse(move|down|up|over|out|enter|leave)$|^contextmenu$/,f=/^(focus|blur|select|change|reset)$|^key(press|down|up)$/,l=/^(scroll|resize|(un)?load|abort|error)$/,c=function(t,n){var r,t=t.toLowerCase();document.createEvent&&this.dispatchEvent?(t=t.replace(u,""),t.match(a)?(e(this).offset(),r=document.createEvent("MouseEvents"),r.initMouseEvent(t,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget)):t.match(f)?(r=document.createEvent("UIEvents"),r.initUIEvent(t,n.bubbles,n.cancelable,n.view,n.detail)):t.match(l)&&(r=document.createEvent("HTMLEvents"),r.initEvent(t,n.bubbles,n.cancelable)),r&&this.dispatchEvent(r)):(t.match(u)||(t="on"+t),r=document.createEventObject(n),this.fireEvent(t,r))};e.pnotify.defaults={title:!1,title_escape:!1,text:!1,text_escape:!1,styling:"bootstrap",addclass:"",cornerclass:"",nonblock:!1,nonblock_opacity:.2,history:!0,width:"300px",min_height:"16px",type:"notice",icon:!0,animation:"fade",animate_speed:"slow",opacity:1,shadow:!0,closer:!0,closer_hover:!0,sticker:!0,sticker_hover:!0,hide:!0,delay:8e3,mouse_reset:!0,remove:!0,insert_brs:!0,stack:{dir1:"down",dir2:"left",push:"bottom",spacing1:25,spacing2:25}}})(jQuery);
